#!/bin/bash
export PS1="\h::\W$ "
NDK_ROOT=/Users/bilal/Downloads/android-ndk-r18b
SDK_ROOT=/Users/bilal/Library/Android/sdk
export ANDROID_NDK_ROOT=$NDK_ROOT
export ANDROID_SDK_ROOT=$SDK_ROOT
export PATH=$PATH:/$SDK_ROOT/tools

export NDK=$NDK_ROOT  
export PATH=$NDK:$PATH

PACKAGE=$1
APPNAME=$2
VERSION=$3
echo -786-------------- COPYING APP ASSETS
cd assets
rm -f *
rm -f bin/$2*.apk
cp ../../../Apps/$2.Assets/Data/* .
cp icon.png ../res/drawable-ldpi
cd ..
echo ------------------ CONFIGURING BUILD
USERSRC=${PACKAGE//'.'/'/'}
cd src
mkdir -p $USERSRC
cd ..
echo CHECK $USERSRC
rm -f jni/CANDIDATE.h
./configdroid $PACKAGE $APPNAME $VERSION
vi AndroidManifest.xml
echo ------------------ COMPILING LIBRARIES
$NDK_ROOT/ndk-build clean
$NDK_ROOT/ndk-build
exit
echo ------------------- BUILDING RELEASE
rm -f res/.DS_Store
rm -f assets/.DS_Store
rm -f res/drawable-ldpi/.DS_Store
vi build.xml
ant -q release
exit
echo ------------------- SIGNING
rm -f bin/$2.apk
jarsigner -verbose -keystore ~/algeandroidapps.keystore bin/$2-unsigned.apk demos
$SDK_ROOT/tools/zipalign -v 4 bin/$2-unsigned.apk bin/$2.apk
cp -vf bin/$2.apk ../Packages/$2.apk
echo -------------------- ALGE ACTIONS COMPLETED [Placed $2.apk in Packages/]
echo Good Luck !!
rm -rf $USERSRC/$2.java
echo install check 
echo $SDK_ROOT/platform-tools/adb uninstall $PACKAGE
$SDK_ROOT/platform-tools/adb install bin/$2.apk
echo Check App on your Device
